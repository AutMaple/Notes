# SpringCloud 模块

- Auth: 用户认证模块
- Admin: 后台管理模块
- Gateway: 网关模块
- Search: 商品搜索模块
- Portal: 前台模块

# 项目中 Redis 用在了什么地方

- 保存验证码，以用户 id 为 key, 生成的验证码为 value, 并且过期事件为 60s
- 存放用户权限资源，方便进行权限认证时快速的读取对应的配置文件

# 项目中 ElasticSearch 用在了什么地方

商品的搜索，将商品信息全部导入 ES 中，并开放接口进行相关的搜索。

# 项目中遇到的难点在哪里
## 1. 项目的权限控制

权限控制主要通过三个表：菜单，资源，角色

1. 角色和菜单的关系: 后台菜单关系
2. 角色和资源的关系: 资源也表示的是接口
3. 可以通过后台配置角色

## 2. 订单的生成与取消

订单的生成主要涉及：促销活动，满减，优惠券，积分，成长值，折扣

下单成功后发送一个延迟消息给 RabbitMQ, 消息的内容是订单的 ID，如果在指定的一个小时内如果订单的状态还是未支付，那么就取消对应的订单。

取消订单就相对的简单，因为在生成订单时，都进行了记录，所以只需要将对应的数据进行恢复即可

## 商品表

- sku 表，里面记录了库存，价格，促销价格

## 促销活动

- 促销活动表：记录促销活动的开始时间，结束时间，促销活动的标题
- 促销活动与商品一张表：记录促销活动与商品的关系，促销时商品的价格
- 促销类型：单品促销，折扣促销，满减促销

## 商品折扣

单品促销：促销活动和商品 ID 一张表

商品折扣表：记录商品打则的条件

商品满减表：记录购买某件商品满减的条件
